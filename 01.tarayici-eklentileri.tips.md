# 01. TarayÄ±cÄ± Eklentileri - Ä°puÃ§larÄ± ve Teknikler

## ğŸ’¡ Praktik Ä°puÃ§larÄ±

---

### ğŸ” Eklenti Analizi Ä°puÃ§larÄ±

**1. HÄ±zlÄ± Eklenti ID Bulma**
```bash
# Chrome eklenti klasÃ¶rÃ¼nÃ¼ listeleme (Linux/macOS)
ls -la ~/.config/google-chrome/Default/Extensions/

# Windows iÃ§in
dir "%LOCALAPPDATA%\Google\Chrome\User Data\Default\Extensions"
```

**2. Manifest.json HÄ±zlÄ± Analizi**
```bash
# Tehlikeli permission'larÄ± arama
grep -r "all_urls\|webRequest\|debugger" ~/.config/google-chrome/Default/Extensions/
```

**3. JavaScript Obfuscation Tespit Etme**
- AÅŸÄ±rÄ± kÄ±sa deÄŸiÅŸken isimleri (`a`, `b`, `c`)  
- Base64 encoded string'ler
- `eval()` ve `Function()` kullanÄ±mÄ±
- Unusual character encoding

---

### âš¡ HÄ±zlÄ± GÃ¼venlik Kontrolleri

**4. Kritik DosyalarÄ± Ã–ncelikle Ä°ncele**
1. `manifest.json` - Ä°zinler ve yapÄ±landÄ±rma
2. `background.js` - Ana Ã§alÄ±ÅŸtÄ±rma kodu  
3. `content.js` - Web sayfasÄ± etkileÅŸimi
4. `popup.js` - KullanÄ±cÄ± arayÃ¼zÃ¼ mantÄ±ÄŸÄ±

**5. Red Flag Permission'lar**
- âš ï¸ `<all_urls>` - TÃ¼m sitelere eriÅŸim
- âš ï¸ `webRequest` - Network trafiÄŸi dinleme
- âš ï¸ `debugger` - TarayÄ±cÄ± debug API'si
- âš ï¸ `management` - DiÄŸer eklentileri yÃ¶netme
- âš ï¸ `nativeMessaging` - Native app'lerle iletiÅŸim

**6. ÅÃ¼pheli Kod Paternleri**
```javascript
// ÅÃ¼pheli network istekleri
fetch('https://suspicious-domain.com', ...)
XMLHttpRequest to unknown domains

// Veri exfiltration
chrome.tabs.onUpdated.addListener(...)
chrome.history.search(...)
document.addEventListener('keydown', ...)

// Dinamik kod yÃ¼kleme
eval(response)
new Function(dynamicCode)
```

---

### ğŸ› ï¸ Analiz AraÃ§larÄ±

**7. Ã–nerilen AraÃ§lar**
```bash
# Chrome DevTools
F12 -> Sources -> Content Scripts

# JavaScript Beautifier
npm install -g js-beautify
js-beautify obfuscated.js

# Static Analysis
# ESLint security rules
npm install -g eslint eslint-plugin-security

# Network Monitoring
# Burp Suite, OWASP ZAP
# Wireshark for deep packet inspection
```

**8. Browser Developer Tools KullanÄ±mÄ±**
- **Console Tab:** JavaScript hatalarÄ± ve log'lar
- **Network Tab:** YapÄ±lan HTTP istekleri
- **Sources Tab:** Kaynak kod debug'Ä±
- **Application Tab:** Extension storage verisi

---

### ğŸ” GÃ¼venlik Test Metodolojisi

**9. Sistematik Analiz AdÄ±mlarÄ±**
```
1. Ä°zin Analizi
   â””â”€ manifest.json permission mapping
   â””â”€ Risk assessment matrix

2. Kod Analizi
   â””â”€ Static code analysis
   â””â”€ Dynamic behavior testing
   â””â”€ Obfuscation detection

3. Network Analizi  
   â””â”€ Outbound connections
   â””â”€ Data exfiltration patterns
   â””â”€ C2 communication

4. Runtime Analizi
   â””â”€ Memory usage patterns
   â””â”€ CPU spikes
   â””â”€ File system access
```

**10. Behavioral Testing**
```javascript
// Test senaryolarÄ±
- ParolalÄ± sitelerde davranÄ±ÅŸ
- BankacÄ±lÄ±k sitelerinde aktivite
- File upload/download iÅŸlemleri
- Private browsing modunda davranÄ±ÅŸ
- Network kesintilerinde reaksiyon
```

---

### ğŸš¨ Incident Response

**11. ÅÃ¼pheli Eklenti BulduÄŸunuzda**
```
Hemen YapÄ±lacaklar:
1. Eklentiyi DEVRE DIÅI BIRAK (kaldÄ±rma!)
2. Network baÄŸlantÄ±larÄ±nÄ± LOGLAYINIZ
3. Browser cache'i TEMÄ°ZLEYÄ°NÄ°Z  
4. DiÄŸer tarayÄ±cÄ±larÄ± KONTROLEDINIZ
5. Åifreleri DEÄÄ°ÅTÄ°RÄ°NÄ°Z

DokÃ¼mantasyon:
1. Eklenti ID ve version kaydedin
2. Manifest.json dosyasÄ±nÄ± YEDEKLEYIN
3. Network log'larÄ±nÄ± KAYDEDIN
4. Timeline oluÅŸturun (ne zaman yÃ¼klendi?)
```

**12. Forensic Evidence Collection**
```bash
# Eklenti dosyalarÄ±nÄ± koruma
cp -r ~/.config/google-chrome/Default/Extensions/[ID] ./evidence/

# AÄŸ baÄŸlantÄ±larÄ± kaydetme  
netstat -tulpn > connections.log

# Browser geÃ§miÅŸi export etme
sqlite3 ~/.config/google-chrome/Default/History ".dump" > history.sql
```

---

### ğŸ“‹ Checklist: GÃ¼venli Eklenti KullanÄ±mÄ±

**13. Kurumsal Ortam Ä°Ã§in**
- [ ] Extension whitelist policy uygulandÄ±
- [ ] Auto-update kapatÄ±ldÄ±
- [ ] Developer mode devre dÄ±ÅŸÄ±
- [ ] Enterprise policy ile kÄ±sÄ±tlamalar
- [ ] Network monitoring aktif
- [ ] Regular security audit yapÄ±lÄ±yor

**14. Bireysel KullanÄ±cÄ± Ä°Ã§in**  
- [ ] Sadece gÃ¼venilir geliÅŸtiricilerden eklenti
- [ ] Permission'larÄ± dikkatli okumak
- [ ] DÃ¼zenli olarak eklenti listesini gÃ¶zden geÃ§irme
- [ ] ÅÃ¼pheli aÄŸ trafiÄŸi izleme
- [ ] Browser'Ä± gÃ¼ncel tutma

---

### ğŸ¯ Advanced Techniques

**15. Sandbox Escape Detection**
```javascript
// Potansiyel sandbox bypass testleri
try {
  // File system access attempts
  chrome.fileSystem.getWritableEntry();
  
  // Native messaging attempts  
  chrome.runtime.connectNative('malicious_app');
  
  // Memory corruption attempts
  new Array(999999999).join('A');
} catch(e) {
  // Log potential exploit attempts
}
```

**16. Extension Fingerprinting**
```javascript
// Sistem bilgisi toplama teknikleri
chrome.runtime.getPlatformInfo()
navigator.userAgent
screen.width, screen.height
timezone detection
installed fonts enumeration
WebRTC IP discovery
```

**17. Persistence Mechanisms**
```javascript
// KalÄ±cÄ±lÄ±k teknikleri
chrome.storage.sync.set() // Cross-device persistence
chrome.alarms.create()    // Scheduled execution
chrome.runtime.onStartup // Browser restart survival
```

---

### âš–ï¸ Legal ve Etik Hususlar

**18. Penetration Testing SÄ±nÄ±rlarÄ±**
- Sadece SÄ°ZÄ°N sistemlerinizde test yapÄ±n
- Ä°zinli penetration testing kapsamÄ±nda kalÄ±n
- Yasal dokÃ¼mantasyon hazÄ±rlayÄ±n
- Zarar verici kodlar kullanmayÄ±n

**19. Responsible Disclosure**
```
1. Zafiyet tespit edildiÄŸinde:
   - Ã–nce vendor'a bildirin
   - 90 gÃ¼n sÃ¼re tanÄ±yÄ±n  
   - Koordineli aÃ§Ä±klama yapÄ±n
   - POC kodlarÄ± yayÄ±nlamayÄ±n

2. Bug bounty programlarÄ±na katÄ±lÄ±n
3. CVE numarasÄ± alÄ±n
4. Toplumsal faydayÄ± gÃ¶zetin
```

---

## ğŸ“š Ã–nerilen Kaynaklar

- **Chrome Extension Security:** https://developer.chrome.com/docs/extensions/mv3/security/
- **OWASP Extension Security:** https://owasp.org/www-pdf-archive/OWASP_Browser_Extension_Security.pdf
- **Mozilla Add-on Security:** https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/Security_best_practices

---

**Geri DÃ¶n:** [01. Sorular](01.tarayici-eklentileri.questions.md) | **Ana Sayfa:** [index.md](index.md) | **Sonraki Konu:** [02. Veri SÄ±zdÄ±rma](02.veri-sizdirma.md)


---


| **By**                                                                                   | **Keyvan Arasteh**                       |
| --------------------------------------------------------------------------------------------------- | --------------------------------- |
| [![LinkedIn](https://img.shields.io/badge/LinkedIn-0A66C2?style=for-the-badge&logo=linkedin&logoColor=white)](https://linkedin.com/keyvanarasteh)   | Istinye Universitesi               |
| [![GitHub](https://img.shields.io/badge/GitHub-181717?style=for-the-badge&logo=github&logoColor=white)](https://github.com/keyvanarasteh)             | Bilisim Guvenligi Teknolojisi     |
| [![YouTube](https://img.shields.io/badge/YouTube-FF0000?style=for-the-badge&logo=youtube&logoColor=white)](https://www.youtube.com/@drvoidgate)        | drvoid gate Channel               |

